<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees Device Detection Node.js: hash/failureToMatch.js</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>

<link href="docs-main.min.css" rel="stylesheet" type="text/css" />

</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->


<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  
  <a id="projectlogo" href="../../documentation/4.1/index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png"/></a>
  
  <span class="c-tagline">51Degrees Device Detection Node.js
   &#160;<span id="projectnumber">4.1</span>
  </span>
  
  </h1>
  
  <div id="projectalign" style="padding-left: 0.5em;">
   <div id="projectbrief">51Degrees Device Detection for Node.js</div>
  </div>
  
  <div id="main-nav"></div>
  
   
     <div class="g-search">
    <div class="c-search is-openable">
    <form class="c-search__form">
      <div id="MSearchBox" class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img id="MSearchSelect" src="icon-search.svg" class="b-icon" alt="Search" 
                 onmouseover="return searchBox.OnSearchSelectShow()"
                 onmouseout="return searchBox.OnSearchSelectHide()"/>
        <input type="text" id="MSearchField" autocomplete="off" class="c-search__input" id="inputSearch" placeholder="Type a class, namespace etc." aria-label="Search"
                 onfocus="searchBox.OnSearchFieldFocus(true)" 
                 onblur="searchBox.OnSearchFieldFocus(false)" 
                 onkeyup="searchBox.OnSearchFieldChange(event)">
         <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
      </div>
    </form>
  </div>
</div>

   
  
</div>

<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('hash_2failure_to_match_8js-example.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="g-docs__header">
<h2 class="g-docs__page-title">hash/failureToMatch.js</h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<p>This examples shows how the hasValue function can help make sure that meaningful values are returned when checking properties returned from the device detection engine. It also illustrates how the "allowUnmatched" parameters can be used to alter these results.</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line"><span class="c-code__comment">/* *********************************************************************</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is copyright of 51 Degrees Mobile Experts Limited.</span></div><div class="c-code__line"><span class="c-code__comment"> * Copyright 2019 51 Degrees Mobile Experts Limited, 5 Charlotte Close,</span></div><div class="c-code__line"><span class="c-code__comment"> * Caversham, Reading, Berkshire, United Kingdom RG4 7BY.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * This Original Work is licensed under the European Union Public Licence (EUPL) </span></div><div class="c-code__line"><span class="c-code__comment"> * v.1.2 and is subject to its terms as set out below.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * If a copy of the EUPL was not distributed with this file, You can obtain</span></div><div class="c-code__line"><span class="c-code__comment"> * one at https://opensource.org/licenses/EUPL-1.2.</span></div><div class="c-code__line"><span class="c-code__comment"> *</span></div><div class="c-code__line"><span class="c-code__comment"> * The &#39;Compatible Licences&#39; set out in the Appendix to the EUPL (as may be</span></div><div class="c-code__line"><span class="c-code__comment"> * amended by the European Commission) shall be deemed incompatible for</span></div><div class="c-code__line"><span class="c-code__comment"> * the purposes of the Work and the provisions of the compatibility</span></div><div class="c-code__line"><span class="c-code__comment"> * clause in Article 5 of the EUPL shall not apply.</span></div><div class="c-code__line"><span class="c-code__comment"> * </span></div><div class="c-code__line"><span class="c-code__comment"> * If using the Work as, or as part of, a network application, by </span></div><div class="c-code__line"><span class="c-code__comment"> * including the attribution notice(s) required under Article 5 of the EUPL</span></div><div class="c-code__line"><span class="c-code__comment"> * in the end user terms of the application under an appropriate heading, </span></div><div class="c-code__line"><span class="c-code__comment"> * such notice(s) shall fulfill the requirements of that article.</span></div><div class="c-code__line"><span class="c-code__comment"> * ********************************************************************* */</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">const</span> FiftyOneDegreesDeviceDetection = require((process.env.directory || __dirname) + <span class="c-code__stringliteral">&quot;/../../&quot;</span>);</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// Load in a datafile</span></div><div class="c-code__line"></div><div class="c-code__line">let datafile = (process.env.directory || __dirname) + <span class="c-code__stringliteral">&quot;/../../device-detection-cxx/device-detection-data/51Degrees-LiteV3.4.trie&quot;</span>;</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// Check if datafiele exists</span></div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__keyword">const</span> fs = require(<span class="c-code__stringliteral">&quot;fs&quot;</span>);</div><div class="c-code__line"><span class="c-code__keywordflow">if</span> (!fs.existsSync(datafile)) {</div><div class="c-code__line">    console.error(<span class="c-code__stringliteral">&quot;The datafile required by this example is not present. Please ensure that the &#39;device-detection-data&#39; submodule has been fetched.&quot;</span>);</div><div class="c-code__line">    <span class="c-code__keywordflow">throw</span> (<span class="c-code__stringliteral">&quot;No data file at &#39;&quot;</span> + datafile + <span class="c-code__stringliteral">&quot;&#39;&quot;</span>);</div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line"><span class="c-code__comment">// Create the device detection pipeline with the desired settings. Note the commented out allowUnmatched setting which will be referenced later in the example.</span></div><div class="c-code__line"></div><div class="c-code__line">let pipeline = <span class="c-code__keyword">new</span> FiftyOneDegreesDeviceDetection.deviceDetectionPipelineBuilder({</div><div class="c-code__line">    performanceProfile: <span class="c-code__stringliteral">&quot;MaxPerformance&quot;</span>,</div><div class="c-code__line">    dataFile: datafile,</div><div class="c-code__line">    autoUpdate: <span class="c-code__keyword">false</span>,</div><div class="c-code__line">    <span class="c-code__comment">// allowUnmatched: true </span></div><div class="c-code__line">}).build();</div><div class="c-code__line"></div><div class="c-code__line">pipeline.on(<span class="c-code__stringliteral">&quot;error&quot;</span>, console.error);</div><div class="c-code__line"></div><div class="c-code__line">let checkIfMobile = async <span class="c-code__keyword">function</span> (userAgent) {</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Create a flow data element and process the desktop User-Agent.</span></div><div class="c-code__line">    let flowData = pipeline.createFlowData();</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__comment">// Add the User-Agent as evidence</span></div><div class="c-code__line">    flowData.evidence.add(<span class="c-code__stringliteral">&quot;header.user-agent&quot;</span>, userAgent);</div><div class="c-code__line"></div><div class="c-code__line">    await flowData.process();</div><div class="c-code__line"></div><div class="c-code__line">    let ismobile = flowData.device.ismobile;</div><div class="c-code__line"></div><div class="c-code__line">    console.log(`Is user agent ${userAgent} a mobile?`);</div><div class="c-code__line"></div><div class="c-code__line">    <span class="c-code__keywordflow">if</span> (ismobile.hasValue) {</div><div class="c-code__line"></div><div class="c-code__line">        console.log(ismobile.value);</div><div class="c-code__line"></div><div class="c-code__line">    } <span class="c-code__keywordflow">else</span> {</div><div class="c-code__line"></div><div class="c-code__line">        <span class="c-code__comment">// Echo out why the value isn&#39;t meaningful</span></div><div class="c-code__line">        console.log(ismobile.noValueMessage);</div><div class="c-code__line"></div><div class="c-code__line">    }</div><div class="c-code__line"></div><div class="c-code__line">    console.log(<span class="c-code__stringliteral">&quot; &quot;</span>);</div><div class="c-code__line"></div><div class="c-code__line">}</div><div class="c-code__line"></div><div class="c-code__line">let iPhoneUA = <span class="c-code__stringliteral">&#39;Mozilla/5.0 (iPhone; CPU iPhone OS 11_2 like Mac OS X) AppleWebKit/604.4.7 (KHTML, like Gecko) Mobile/15C114&#39;</span>;</div><div class="c-code__line">checkIfMobile(iPhoneUA)</div><div class="c-code__line"><span class="c-code__comment">// This User-Agent is from an iPhone. It should match correctly and be identified as a mobile device</span></div><div class="c-code__line"></div><div class="c-code__line">let modifiediPhoneUA = <span class="c-code__stringliteral">&#39;Mozilla/5.0 (iPhone; CPU iPhone OS 99_2 like Mac OS X) AppleWebKit/604.4.7 (KHTML, like Gecko) Mobile/15C114&#39;</span>;</div><div class="c-code__line">checkIfMobile(modifiediPhoneUA)</div><div class="c-code__line"><span class="c-code__comment">//This User-Agent is from an iPhone but has been modified so it doesn&#39;t match exactly.</span></div><div class="c-code__line"><span class="c-code__comment">// By default the API will not match this but can be configured to do so by changing the &#39;difference&#39; parameter when building the engine.</span></div><div class="c-code__line"></div><div class="c-code__line">let corruptedUA = <span class="c-code__stringliteral">&#39;This is not a User-Agent&#39;</span>;</div><div class="c-code__line">checkIfMobile(corruptedUA);</div><div class="c-code__line"><span class="c-code__comment">//This User-Agent is fake and will not be matched. If you still want a match returned in this case then you can set the &#39;unmatched&#39; parameter flag when building the engine. This will cause the &#39;default&#39; profiles to be returned.</span></div></div> </div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
